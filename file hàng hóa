#include <stdio.h>
#include<conio.h>
#include<stdlib.h>
#include<windows.h>
#include<stdbool.h>
FILE* f;
typedef struct hanghoa
{
	char tenhang[100];
	int soluong;
	int dongia;
	float tien;
} hanghoa;
int n=0;
int u=0;
hanghoa h[1000000];
hanghoa nhaphang()
{
	hanghoa h;
	printf("\t Mời bạn nhập tên hàng: ");
	fflush(stdin);
	gets(h.tenhang);
	printf("\n");
	printf("\t Mời bạn nhập số lượng: ");
	scanf("%d",&h.soluong);
	printf("\n");
	printf("\t Mời bạn nhập đơn giá: ");
	scanf("%d",&h.dongia);
	printf("\n");
	h.tien = h.soluong * h.dongia;
	return h;
}
void hienthi(hanghoa h)
{
	printf("%25s%10d%10d%15.3f\n",h.tenhang,h.soluong,h.dongia,h.tien);
}
void hienthids()
{
	printf("\t\tSO LIEU BAN HANG\n");
    printf("%5s%25s%10s%10s%15s\n","STT","Ten Hang","Don gia","So luong","Thanh tien");
    if (n==0) printf("\tKhông có mặt hàng nào\n");
    else {
        for (int i=0; i<n; i++){
            printf(" %3d",i+1);
            hienthi(h[i]);
        }
    }
}
void taodanhsach()
{
	int k;
	printf("\t Mời bạn nhập số đơn hàng: ");
	scanf("%d",&k);
	printf("\n");
	for(int i=0 ;i<k;i++)
	{
		h[i] = nhaphang();
		u = u+1;
	}
	n = u;
}
void nhaptiep()
{
	int m;
	printf("\t Mời bạn nhập tiếp số đơn hàng: ");
	scanf("%d",&m);
	printf("\n");
	for(int i=u ;i<u+m;i++)
	{
		h[i] = nhaphang();
		n = n+1;
	}
}
void menu()
{
	printf("\t 1.Tạo đơn hàng\n");
	printf("\t 2.Thêm đơn hàng\n");
	printf("\t 3.Hiển thị nội dung trong file\n");
	printf("\t 4.Thoát chương trình\n");
}
int main()
{
	SetConsoleOutputCP(65001);
	int chon;
	while(true)
	{
		system("cls");
		menu();
		printf("Mời bạn chọn: ");
		scanf("%d",&chon);
		printf("\n");
		switch(chon)
		{
			case 1:
			        system("cls");
			        f = fopen("F:\\hanghoa.c","wb");
			        taodanhsach();
			        fwrite(&h,sizeof(h),1,f);
			        fclose(f);
			         printf("\n");
                      printf("\tBấm phím bất kỳ để trở về menu ");
                      getch();
			        break;
			case 2:
			        system("cls");
			        f = fopen("F:\\hanghoa.c","wb");
			        nhaptiep();
			        fwrite(&h,sizeof(h),1,f);
			        fclose(f);
			         printf("\n");
                      printf("\tBấm phím bất kỳ để trở về menu ");
                      getch();
			        break;
			case 3:
			        system("cls");
			        f = fopen("F:\\hanghoa.c","rb");
			        fread (&h,sizeof(h),1,f);
			        hienthids();
			        fclose(f);
			         printf("\n");
                      printf("\tBấm phím bất kỳ để trở về menu ");
                      getch();
                      break;
			case 4: 
			        system("cls");
                     printf("\tBấm phím bất kỳ để thoát chương trình: ");
                     getch();
                     printf("\n");
                     printf("\tTạm Biệt\n");
                     exit(0);
            default:
                      system("cls");
                      printf("------------------>Nhập từ 1 đến 4\n");

		}
	}
}
