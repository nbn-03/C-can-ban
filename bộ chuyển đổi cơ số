#include<stdio.h>
#include<stdbool.h>
#include<math.h>
#include <string.h>
#include <windows.h>
#include <conio.h>
int top = -1;
int stack[100];
int max=100;
bool stackrong()
{
    if(top==-1)
     return true;
    return false;
}
bool stackday()
{
    if(top==max-1)
     return true;
    return false;
}
void in1()
{
    printf("%d",stack[top]); 
}
void in2()
{
    if(stack[top]==0)
       printf("%d",0);
    else if(stack[top]==1)
       printf("%d",1);
    else if(stack[top]==10)
       printf("%d",2);
    else if(stack[top]==11)
       printf("%d",3);
    else if(stack[top]==100)
       printf("%d",4);
    else if(stack[top]==101)
       printf("%d",5);
    else if(stack[top]==110)
       printf("%d",6);
    else if(stack[top]==111)
       printf("%d",7);
    else if(stack[top]==1000)
       printf("%d",8);
    else if(stack[top]==1001)
       printf("%d",9);
    else if(stack[top]==1010)
       printf("%c",65);
    else if(stack[top]==1011)
       printf("%c",66);
    else if(stack[top]==1100)
       printf("%c",67);
    else if(stack[top]==1101)
       printf("%c",68);
    else if(stack[top]==1110)
       printf("%c",69);
    else if(stack[top]==1111)
       printf("%c",70); 
}
void in3()
{
    printf("%04d",stack[top]); 
}
void in4()
{
    if(stack[top]>=65 && stack[top]<=70)
        printf("%c",stack[top]);
    else
         printf("%d",stack[top]); 
 
}
void themdinh1(int data)
{
    if(stackday()==true)
    printf("stack full");
    else
    {
        top=top+1;
        stack[top]=data;
    }
}
void themdinh2(int data)
{
    if(stackday()==true)
    printf("stack full");
    else
    {
        top=top+1;
        if(data<10)
            stack[top]=data;
        else if(data == 10)
            stack[top]=65;
        else if(data == 11)
            stack[top]=66;
        else if(data == 12)
            stack[top]=67;
        else if(data == 13)
            stack[top]=68;
        else if(data == 14)
            stack[top]=69;
        else if(data == 15)
            stack[top]=70;
    }
}
void xoadinh()
{
    if(stackrong()==true)
     printf("stack rong");
    else
    {
        top=top-1;
    }
}
void SetColor(int backgound_color, int text_color)
{
    HANDLE hStdout = GetStdHandle(STD_OUTPUT_HANDLE);
 
    int color_code = backgound_color * 16 + text_color;
    SetConsoleTextAttribute(hStdout, color_code);
}
void GoTo(SHORT posX, SHORT posY)
{
	HANDLE hStdout = GetStdHandle(STD_OUTPUT_HANDLE);
    COORD Position;
    Position.X = posX;
    Position.Y = posY;
 
	SetConsoleCursorPosition(hStdout, Position);
}
void DisableSelection()
{
    HANDLE hStdin = GetStdHandle(STD_INPUT_HANDLE);
 
    SetConsoleMode(hStdin, ~ENABLE_QUICK_EDIT_MODE);
}
void ShowCur(bool CursorVisibility)
{
	HANDLE handle = GetStdHandle(STD_OUTPUT_HANDLE);
    CONSOLE_CURSOR_INFO ConCurInf;
 
    ConCurInf.dwSize = 10;
    ConCurInf.bVisible = CursorVisibility;
 
    SetConsoleCursorInfo(handle, &ConCurInf);
}
void chaomung()
{
	SetConsoleOutputCP(65001);
	GoTo(80,0);
	SetColor(0,4);
	printf("Chào mừng bạn đến với bộ chuyển đổi cơ số");
	GoTo(80,3);
	printf("DEV: Nguyễn Bảo Ngọc");
}
void menu1()
{
	SetConsoleOutputCP(65001);
	GoTo(80,8);
	SetColor(0,4);
	printf("1. Nhập cơ số 10");
	GoTo(80,9);
	printf("2. Nhập cơ số 2");
	GoTo(80,10);
	printf("3. Nhập cơ số 16");
	GoTo(80,11);
	printf("4. Kết thúc chương trình");
}
void menu2()
{
	SetConsoleOutputCP(65001);
	SetColor(0,4);
	GoTo(80,15);
	printf("1. Chuyển cơ số 2");
	GoTo(80,16);
	printf("2. Chuyển cơ số 16");
}
void menu3()
{
	SetConsoleOutputCP(65001);
	SetColor(0,4);
	GoTo(80,17);
	printf("1. Chuyển cơ số 10");
	GoTo(80,18);
	printf("2. Chuyển cơ số 16");
}
void menu4()
{
	SetConsoleOutputCP(65001);
	SetColor(0,4);
	GoTo(80,19);
	printf("1. Chuyển cơ số 10");
	GoTo(80,20);
	printf("2. Chuyển cơ số 2");
}
void doicoso10sang2(int value)
{
    while(value>0)
    {
        themdinh1(value%2);
        value=value/2;
    }
}
void bodoicoso10sang2()
{
	int value;
	printf("\t Mời bạn nhập: ");
    scanf("%d",&value);
    doicoso10sang2(value);
    printf("Kết quả là: ");
    do
    {
        in1();
        xoadinh();
    }
    while(top!=-1);
}
void doicoso10sang16(int value)
{
    while(value>0)
    {
        themdinh2(value%16);
        value=value/16;
    }
}
void bodoicoso10sang16()
{
	int value;
	printf("\t Mời bạn nhập: ");
    scanf("%d",&value);
    doicoso10sang16(value);
    printf("\t Kết quả là: ");
    do
    {
        in4();
        xoadinh();
    }
    while(top!=-1);
}
void timgiaithua1(int value)
{
    while(value>0)
    {
        themdinh1(value%10);
        value=value/10;
    }
}
int kiemtra1()
{
    int dem=0;
    for(int i=0;i<=top;i++)
    {
        if(stack[i]==1 || stack[i]==0)
            dem=dem+1;
 
    }
    return dem;
}
void chuyencoso2sang10(int value)
{
    int k=0;
        for(int i=0;i<=top;i++)
        {
            k=k+(stack[i]*pow(2,i));
        }
    printf("\t Kết quả là: %d",k);
}
void bodoicoso2sang10()
{
	int value;
	printf("\t Mời bạn nhập: ");
    scanf("%d",&value);
    timgiaithua1(value);
    if(kiemtra1()==top+1)
    {
       chuyencoso2sang10(value); 
    }
    else
        printf("Không phải là cơ số 2");
}
void phahuystack()
{
    top=-1;
}
void timgiaithua2(int value)
{
    while(value>0)
    {
        themdinh1(value%10);
        value=value/10;
    }
}
int kiemtra2()
{
    int dem=0;
    for(int i=0;i<=top;i++)
    {
        if(stack[i]==1 || stack[i]==0)
            dem=dem+1;
 
    }
    return dem;
}
void xacminh()
{
    if(kiemtra2()==top+1)
    {
        phahuystack();
    }
    else
        printf("so ban nhap khong phai la co so 2");
}
void doicoso2sang16(int value)
{
    while(value>0)
    {
        themdinh1(value%10000);
        value=value/10000;
    }
}
void bodoicoso2sang16()
{
	int value;
	printf("\t Mời bạn nhập: ");
    scanf("%d",&value);
    xacminh();
    printf("\t Kết quả là: ");
    doicoso2sang16(value);
    do
    {
        in2();
        xoadinh();
    }
    while(top!=-1);
}
void nhapchuoi1()
{
    int dem=0;
    char a[100];
    printf("\t Mời bạn nhập: ");
    fflush(stdin);
    gets(a);
    strupr(a);
    int k = strlen(a);
    for(int i=0;i<k;i++)
    {
        if(a[i]==65)
        {
            themdinh1(10);
        }
        else if(a[i]==66)
        {
            themdinh1(11);
        }
        else if(a[i]==67)
        {
            themdinh1(12);
        }
        else if(a[i]==68)
        {
            themdinh1(13);
        }
        else if(a[i]==69)
        {
            themdinh1(14);
        }
        else if(a[i]==70)
        {
            themdinh1(15);
        }
        else if(a[i]==48)
        {
            themdinh1(0);
        }
        else if(a[i]==49)
        {
            themdinh1(1);
        }
        else if(a[i]==50)
        {
            themdinh1(2);
        }
        else if(a[i]==51)
        {
            themdinh1(3);
        }
        else if(a[i]==52)
        {
            themdinh1(4);
        }
        else if(a[i]==53)
        {
            themdinh1(5);
        }
        else if(a[i]==54)
        {
            themdinh1(6);
        }
        else if(a[i]==55)
        {
            themdinh1(7);
        }
        else if(a[i]==56)
        {
            themdinh1(8);
        }
        else if(a[i]==57)
        {
            themdinh1(9);
        }
        else
        {
            dem=dem+1;
        }
    }
    if(dem!=0)
    {
        top=-1;
    }
}
void chuyencoso16sang10()
{
    if(top!=-1){
    int k=0;
        for(int i=top;i>=0;i--)
        {
            k=k+(stack[i]*pow(16,(top-i)));
        }
    printf("\t Kết quả là: %d",k);}
    else
        printf("\t Không phải là cơ số 16");
}
void bodoicoso16sang10()
{
	nhapchuoi1();
    chuyencoso16sang10();
}
void nhapchuoi2()
{
    int dem=0;
    char a[100];
    printf("\t Mời bạn nhập: ");
    fflush(stdin);
    gets(a);
    strupr(a);
    int k = strlen(a);
    for(int i=k-1;i>=0;i--)
    {
        if(a[i]==65)
        {
            themdinh1(1010);
        }
        else if(a[i]==66)
        {
            themdinh1(1011);
        }
        else if(a[i]==67)
        {
            themdinh1(1100);
        }
        else if(a[i]==68)
        {
            themdinh1(1101);
        }
        else if(a[i]==69)
        {
            themdinh1(1110);
        }
        else if(a[i]==70)
        {
            themdinh1(1111);
        }
        else if(a[i]==48)
        {
            themdinh1(0);
        }
        else if(a[i]==49)
        {
            themdinh1(1);
        }
        else if(a[i]==50)
        {
            themdinh1(10);
        }
        else if(a[i]==51)
        {
            themdinh1(11);
        }
        else if(a[i]==52)
        {
            themdinh1(100);
        }
        else if(a[i]==53)
        {
            themdinh1(101);
        }
        else if(a[i]==54)
        {
            themdinh1(110);
        }
        else if(a[i]==55)
        {
            themdinh1(111);
        }
        else if(a[i]==56)
        {
            themdinh1(1000);
        }
        else if(a[i]==57)
        {
            themdinh1(1001);
        }
        else
        {
            dem=dem+1;
        }
    }
    if(dem!=0)
        top=-1;
}
void chuyencoso16sang2()
{
    if(top!=-1){
    	printf("\t Kết quả là: ");
    while(top!=-1)
    {
       in3();
       xoadinh(); 
    }}
    else
        printf("\t Không phải là cơ số 16");
}
void bodoicoso16sang2()
{
	nhapchuoi2();
    chuyencoso16sang2();
}
int main()
{
	ShowCur(0);
	int chon;
	while(true)
	{
		system("cls");
		chaomung();
	    menu1();
	    SetConsoleOutputCP(65001);
	    GoTo(80,12);
	    SetColor(0,4);
	    printf("------> Mời bạn chọn:");
	    scanf("%d",&chon);
	    switch (chon)
	    {
	    	case 1: 
	    	    system("cls");
	    	    menu2();
	    	    int chon1;
	    	    printf("------> Mời bạn chọn:");
	            scanf("%d",&chon1);
	            switch (chon1){
	            case 1:
	            system("cls");
	            bodoicoso10sang2();
	            printf("\n");
	            printf("Nhấn 2 lần Enter để trở về màn hình chính");
	            getch();
	            break;
	            case 2:
	            system("cls");
	            bodoicoso10sang16();
	            printf("\n");
	            printf("Nhấn 2 lần Enter để trở về màn hình chính");
	            getch();
	            break;}
				getch();
	    	    break;
	    	case 2:
	    	    system("cls");
	    	    menu3();
	    	    int chon2;
	    	    printf("------> Mời bạn chọn:");
	            scanf("%d",&chon2);
	            switch (chon2){
	            case 1:
	            system("cls");
	            bodoicoso2sang10();
	            printf("\n");
	            printf("Nhấn 2 lần Enter để trở về màn hình chính");
	            getch();
	            break;
	            case 2:
	            system("cls");
	            bodoicoso2sang16();
	            printf("\n");
	            printf("Nhấn 2 lần Enter để trở về màn hình chính");
	            getch();
	            break;}
	            getch();
	    	    break;
	    	case 3:
	    	    system("cls");
	    	    menu4();
	    	    int chon3;
	    	    printf("------> Mời bạn chọn:");
	            scanf("%d",&chon3);
	            switch (chon3){
	            case 1:
	            system("cls");
	            bodoicoso16sang10();
	            printf("\n");
	            printf("Nhấn 2 lần Enter để trở về màn hình chính");
	            getch();
	            break;
	            case 2:
	            system("cls");
	            bodoicoso16sang2();
	            printf("\n");
	            printf("Nhấn 2 lần Enter để trở về màn hình chính");
	            getch();
	            break;}
	    	    getch();
	    	    break;
	    	case 4:
	    	    exit(0);
	    }
	}
	return 0;
}
