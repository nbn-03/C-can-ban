#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>
#include <time.h>
#include <conio.h>
#define true 1
#define false 0
 
//Loop
 
void saoChepMangChuoi (char strSaoChep[][30], char strBanDau[][30], int n)
{
    for (int i=0; i<n; i++)
    {
        strcpy(strSaoChep[i],strBanDau[i]);
    }
}
 
void sapXepHoTen (char hoTen[][30], int n)
{
    char tam1[30] = {'\0'}, tam2[30] = {'\0'};
    for (int i=0; i<n-1; i++)
    {
        for (int j=i+1; j<n; j++)
        {
            //strupr //String uppercase
            strcpy(tam1, hoTen[i]);
            strupr(tam1);
            strcpy(tam2, hoTen[j]);
            strupr(tam2);
            if (strcmp(tam1,tam2) > 0)        //string compare
            {
                char tmp[30];
                strcpy(tmp, hoTen[i]);
                strcpy(hoTen[i], hoTen[j]);
                strcpy(hoTen[j], tmp);
            }
        }
    }
}
 
void inChuoiHienThi (char chuoiHienThi[])
{
    for (int i=0; i<strlen(chuoiHienThi); i++)
        printf("%c ",chuoiHienThi[i]);
    printf("\n");
}
 
void taoChuoiHienThi (char chuoiBanDau[], char chuoiHienThi[])
{
    for (int i=0; i<=strlen(chuoiBanDau); i++)
    {
        if (chuoiBanDau[i]>='A' && chuoiBanDau[i]<='Z')
            chuoiHienThi[i] = '_';
        else
            chuoiHienThi[i] = chuoiBanDau[i];
    }
}
 
int genRandInt (int min, int max)
{
    return min + rand()%(max-min+1);
}
 
int demSoLanXuatHienTrongChuoi (char kiTu, char chuoi[])
{
    int dem = 0;
    for (int i=0; i<strlen(chuoi); i++)
        if (chuoi[i] == kiTu)
            dem++;
    return dem;
}
 
void themKiTuVaoCuoiChuoi (char chuoi[], char kiTu)
{
    if (demSoLanXuatHienTrongChuoi(kiTu,chuoi)==0)
    {
        chuoi[strlen(chuoi)] = kiTu;
        chuoi[1+strlen(chuoi)] = '\0';
    }
}
 
void moChuCaiTrongChuoiHienThi (char kiTu, char chuoiBanDau[], char chuoiHienThi[])
{
    for (int i=0; i<strlen(chuoiBanDau); i++)
        if (chuoiBanDau[i] == kiTu)
            chuoiHienThi[i] = kiTu;
}
 
int laThangCuoc (char chuoiBanDau[], char chuoiHienThi[])
{
    return strcmp(chuoiBanDau,chuoiHienThi)==0;
}
 
int main()
{
    srand(time(NULL));
    char tinhThanh[50][30] = {  "Ha Noi",
                                "Yen Bai",
                                "Tuyen Quang",
                                "Phu Tho",
                                "Lao Cai",
                                "Son La",
                                "Lai Chau",
                                "Dien Bien",
                                "Vinh Phuc",
                                "Bac Ninh",
                                "Thai Nguyen",
                                "Hai Duong",
                                "Hai Phong",
                                "Bac Giang",
                                "Ha Giang",
                                "Thanh Hoa",
                                "Ha Tinh",
                                "Nghe An",
                                "Ninh Binh",
                                "Nam Dinh",
                                "Ha Nam"
                             };
 
    int n = 21;
    int life = 5;
 
    //Get string
    while (life > 0)
    {
        char kiTuDaDoan[30] = {'\0'};
        char chuoiBanDau[30], chuoiHienThi[30];
        strcpy (chuoiBanDau,tinhThanh[genRandInt(0,n-1)]);
        strupr(chuoiBanDau);
        taoChuoiHienThi(chuoiBanDau,chuoiHienThi);
 
 
        while (true)
        {
            //Hiển thị chuỗi chưa mở
            system("cls");
            inChuoiHienThi(chuoiHienThi);
            printf("\tLife: %d\n",life);
            printf("\tBan da doan: ");
            inChuoiHienThi(kiTuDaDoan);
 
            //Cho người dùng chọn 1 kí tự để mở
            printf("\tNhap ki tu doan: ");
            fflush(stdin);
            char kiTuDoan = getchar();
            if (kiTuDoan>='a' && kiTuDoan<='z')
                kiTuDoan = kiTuDoan - 'a' + 'A';
            themKiTuVaoCuoiChuoi(kiTuDaDoan,kiTuDoan);
 
 
            ////Kiểm tra kí tự có tồn tại hay không
            if (demSoLanXuatHienTrongChuoi(kiTuDoan,chuoiBanDau)==0)
            {
                printf("Khong tim thay ki tu %c\n",kiTuDoan);
                life--;
                if (life == 0)
                {
                    printf("GAME OVER\n");
                    printf("Chuoi can doan la: %s\n",chuoiBanDau);
                    return 0;
                }
            }
            else
            {
                printf("Co %d chu cai %c\n",demSoLanXuatHienTrongChuoi(kiTuDoan,chuoiBanDau),kiTuDoan);
                moChuCaiTrongChuoiHienThi(kiTuDoan,chuoiBanDau,chuoiHienThi);
                if (laThangCuoc(chuoiBanDau,chuoiHienThi))
                {
                    printf("Chuc mung, ban da doan dung\n");
                    printf("Chuoi can doan la: %s\n",chuoiBanDau);
                    printf("Bam phim bat ky de choi tiep");
                    getch();
                    break;
                }
            }
 
        }
    }
 
 
}
